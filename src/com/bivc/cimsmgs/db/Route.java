package com.bivc.cimsmgs.db;

// Generated 13.05.2011 15:11:19 by Hibernate Tools 3.4.0.CR1

import com.fasterxml.jackson.annotation.*;
import org.apache.commons.lang.StringUtils;

import java.io.Serializable;
import java.math.BigDecimal;
import java.util.*;

/**
 * Route generated by hbm2java
 */
@JsonIgnoreProperties({"dattr", "cimSmgsScans", "cimSmgses", "routeGroupses", "routeDocs", "invoices", "packDocs", "invoicesBrief", "cimSmgsFileInfs", "routePrintTemplateses", "routeUnPrintTemplateses", "doc2docTemplsRouteUnRefses", "doc2docTemplsRouteRefses"})
public class Route implements Serializable, Comparable<Route> {

    private Long hid;
    private Project project;
    private String name;
    private Date dattr;
    private String un;
    private Date locked;
    private String unLock;
    private Date altered;
    private String tbc_st_code;
    private String customCode;
    private Set<CimSmgsScan> cimSmgsScans = new HashSet<CimSmgsScan>(0);
    private Set<CimSmgs> cimSmgses = new HashSet<CimSmgs>(0);
    private Set<RouteGroups> routeGroupses = new HashSet<RouteGroups>(0);
    private Set<RoutePrintTemplates> routePrintTemplateses = new HashSet<RoutePrintTemplates>(0);
    private Set<RouteUnPrintTemplates> routeUnPrintTemplateses = new HashSet<RouteUnPrintTemplates>(0);
    private List<RouteDoc> routeDocs = new ArrayList<RouteDoc>(0);
    private Set<CimSmgsInvoice> invoices = new HashSet<CimSmgsInvoice>(0);
    private Set<PackDoc> packDocs = new HashSet<PackDoc>(0);
    //    private Set<CimSmgsInvoiceBrief> invoicesBrief = new HashSet<CimSmgsInvoiceBrief>(0);
    private Set<CimSmgsFileInf> cimSmgsFileInfs = new HashSet<CimSmgsFileInf>(0);
    private Long project_hid;
    private List<UsrGroupsDir> grps = new ArrayList<UsrGroupsDir>();
    private List<DocDir> dcs = new ArrayList<DocDir>();
    private Set<Doc2docTemplsRouteUnRefs> doc2docTemplsRouteUnRefses = new HashSet<Doc2docTemplsRouteUnRefs>();
    private Set<Doc2docTemplsRouteRefs> doc2docTemplsRouteRefses = new HashSet<Doc2docTemplsRouteRefs>();

    public Set<Doc2docTemplsRouteRefs> getDoc2docTemplsRouteRefses() {
        return doc2docTemplsRouteRefses;
    }

    public void setDoc2docTemplsRouteRefses(Set<Doc2docTemplsRouteRefs> doc2docTemplsRouteRefses) {
        this.doc2docTemplsRouteRefses = doc2docTemplsRouteRefses;
    }

    public Set<Doc2docTemplsRouteUnRefs> getDoc2docTemplsRouteUnRefses() {
        return doc2docTemplsRouteUnRefses;
    }

    public void setDoc2docTemplsRouteUnRefses(Set<Doc2docTemplsRouteUnRefs> doc2docTemplsRouteUnRefses) {
        this.doc2docTemplsRouteUnRefses = doc2docTemplsRouteUnRefses;
    }
//    private Set<PrintTemplates> printTemplateses = new HashSet<PrintTemplates>();


    public Set<RoutePrintTemplates> getRoutePrintTemplateses() {
        return routePrintTemplateses;
    }

    public void setRoutePrintTemplateses(Set<RoutePrintTemplates> routePrintTemplateses) {
        this.routePrintTemplateses = routePrintTemplateses;
    }

    public List<UsrGroupsDir> getGrps() {
        return grps;
    }

    public void setGrps(List<UsrGroupsDir> grps) {
        this.grps = grps;
    }

    /*public String getGrps(){
        StringBuilder buffer = new StringBuilder();
        String prefix = "";
        for (RouteGroups routeGroup : routeGroupses) {
            buffer.append(prefix);
            prefix = ",";
            buffer.append(routeGroup.getUsrGroupsDir().getName());
        }
        return buffer.toString();
    }*/

    /*public String getDcs(){
        StringBuilder buffer = new StringBuilder();
        String prefix = "";
        for (RouteDoc routeDoc : routeDocs) {
            buffer.append(prefix);
            prefix = ",";
            buffer.append(routeDoc.getDocDir().getDescr());
        }
        return buffer.toString();
    }*/

    public Long getProject_hid() {
        return project.getHid();
    }

    public Set<CimSmgsFileInf> getCimSmgsFileInfs() {
        return cimSmgsFileInfs;
    }

    public void setCimSmgsFileInfs(Set<CimSmgsFileInf> cimSmgsFileInfs) {
        this.cimSmgsFileInfs = cimSmgsFileInfs;
    }

    /*public Set<CimSmgsInvoiceBrief> getInvoicesBrief() {
        return invoicesBrief;
    }

    public void setInvoicesBrief(Set<CimSmgsInvoiceBrief> invoicesBrief) {
        this.invoicesBrief = invoicesBrief;
    }*/

    public Set<CimSmgsInvoice> getInvoices() {
        return invoices;
    }

    public void setInvoices(Set<CimSmgsInvoice> invoices) {
        this.invoices = invoices;
    }

//    public Set<RouteDoc> getRouteDocs() {
//        return routeDocs;
//    }
//
//    public void setRouteDocs(Set<RouteDoc> routeDocs) {
//        this.routeDocs = routeDocs;
//    }

    public List<UsrGroupsDir> getGroups() {
        ArrayList<UsrGroupsDir> groups = new ArrayList<UsrGroupsDir>();
        for (RouteGroups routeGroup : routeGroupses) {
            routeGroup.getUsrGroupsDir().setRoute_hid(this.getHid());
            groups.add(routeGroup.getUsrGroupsDir());
        }
        return groups;
    }

    public void prepareGroups4Save() {
        for (UsrGroupsDir group : grps) {
            routeGroupses.add(new RouteGroups(this, group));
        }
    }

    public List<DocDir> getDocs() {
        ArrayList<DocDir> docs = new ArrayList<DocDir>();
        for (RouteDoc routeDoc : routeDocs) {
            routeDoc.getDocDir().setRoute_hid(this.getHid());
            docs.add(routeDoc.getDocDir());
        }
        return docs;
    }

    public void prepareDocs4Save() {
        for (int i = 0; i < dcs.size(); i++) {
            routeDocs.add(new RouteDoc(this, dcs.get(i), new BigDecimal(i + 1)));
        }
    }

   /* public void preparePrintTemplate4Save(PrintTemplates printTemplate){
        printTemplate.setRoute(this);
        getPrintTemplateses().add(printTemplate);

        printTemplate.setDefaults(false);
//        printTemplate.setName(printTemplate.getName() + " " + );
//        printTemplate.setUsrGroupsDir(this.get);

    }*/

    public Set<RouteGroups> getRouteGroupses() {
        return routeGroupses;
    }

    public void setRouteGroupses(Set<RouteGroups> routeGroupses) {
        this.routeGroupses = routeGroupses;
    }

    public Set<CimSmgs> getCimSmgses() {
        return cimSmgses;
    }

    public void setCimSmgses(Set<CimSmgs> cimSmgses) {
        this.cimSmgses = cimSmgses;
    }

    public Set<CimSmgsScan> getCimSmgsScans() {
        return cimSmgsScans;
    }

    public void setCimSmgsScans(Set<CimSmgsScan> cimSmgsScans) {
        this.cimSmgsScans = cimSmgsScans;
    }

    public Route() {
    }

    public Route(Long hid) {
        this.hid = hid;
    }

    public Route(Long hid, Project project) {
        this.hid = hid;
        this.project = project;
    }

    public Route(Long hid, Project project, String name, Date dattr, String un, Date locked, String unLock, Date altered, Set routeGroupses,
                 Set routeDocs) {
        this.hid = hid;
        this.project = project;
        this.name = name;
        this.dattr = dattr;
        this.un = un;
        this.locked = locked;
        this.unLock = unLock;
        this.altered = altered;
    }

    public Long getHid() {
        return this.hid;
    }

    public void setHid(Long hid) {
        this.hid = hid;
    }

    @JsonBackReference
    public Project getProject() {
        return this.project;
    }

    @JsonBackReference
    public void setProject(Project project) {
        this.project = project;
    }

    public String getName() {
        return this.name;
    }

    public void setName(String name) {
        this.name = name;
    }

    public Date getDattr() {
        return this.dattr;
    }

    public void setDattr(Date dattr) {
        this.dattr = dattr;
    }

    public String getUn() {
        return this.un;
    }

    public void setUn(String un) {
        this.un = un;
    }

    public Date getLocked() {
        return this.locked;
    }

    public void setLocked(Date locked) {
        this.locked = locked;
    }

    public String getUnLock() {
        return this.unLock;
    }

    public void setUnLock(String unLock) {
        this.unLock = unLock;
    }

    public Date getAltered() {
        return this.altered;
    }

    public void setAltered(Date altered) {
        this.altered = altered;
    }

    public String getTbc_st_code() {
        return tbc_st_code;
    }

    public void setTbc_st_code(String tbc_st_code) {
        this.tbc_st_code = tbc_st_code;
    }

    public Set<PackDoc> getPackDocs() {
        return packDocs;
    }

    public void setPackDocs(Set<PackDoc> packDocs) {
        this.packDocs = packDocs;
    }

    @JsonManagedReference
    public List<RouteDoc> getRouteDocs() {
        return routeDocs;
    }

    @JsonManagedReference
    public void setRouteDocs(List<RouteDoc> routeDocs) {
        this.routeDocs = routeDocs;
    }

    public void setProject_hid(Long project_hid) {
        this.project_hid = project_hid;
    }

    public List<DocDir> getDcs() {
        return dcs;
    }

    public void setDcs(List<DocDir> dcs) {
        this.dcs = dcs;
    }

   /* public List<DocDir> docsWithoutPrintTemplate(){
        List<DocDir> docDirs = new ArrayList<DocDir>();
        boolean missed = true;
        for(DocDir docDir : getDcs()){
            for(PrintTemplates printTemplate : getPrintTemplateses()){
                if(docDir.getHid() == printTemplate.getDocDir().getHid()){
                    missed = false;
                    break;
                }
            }
            if(missed){
                docDirs.add(docDir);
            }
        }
        return docDirs;
    }*/

    public int compareTo(Route aThat) {
        final int BEFORE = -1;
        final int EQUAL = 0;
        final int AFTER = 1;
        if (this == aThat) return EQUAL;
        if (this.getHid() == null || aThat.getHid() == null) return AFTER;
        if (this.getHid() < aThat.getHid()) return BEFORE;
        if (this.getHid() > aThat.getHid()) return AFTER;
        return EQUAL;
    }

    @Override
    public boolean equals(Object o) {
        if (this == o) return true;
        if (!(o instanceof Route)) return false;

        Route route = (Route) o;

        if (!hid.equals(route.hid)) return false;
        if (!name.equals(route.name)) return false;

        return true;
    }

    @Override
    public int hashCode() {
        int result = hid.hashCode();
        result = 31 * result + name.hashCode();
        return result;
    }

    public String canHaveThisPrintTemplate(Integer docId, Long hidTempl) {
        PrintTemplates prnTmpl;
        for (RoutePrintTemplates routePrnTmpl : routePrintTemplateses) {
            prnTmpl = routePrnTmpl.getPrintTemplates();
            if (!prnTmpl.getHid().equals(hidTempl) && prnTmpl.getDocDir().getHid().intValue() == docId) {   // has refs, but not mine -> binded somewhere else
                return StringUtils.defaultString(prnTmpl.getName());
            }
        }
        return null;
    }

    public String getCustomCode() {
        return customCode;
    }

    public void setCustomCode(String customCode) {
        this.customCode = customCode;
    }

    public Set<RouteUnPrintTemplates> getRouteUnPrintTemplateses() {
        return routeUnPrintTemplateses;
    }

    public void setRouteUnPrintTemplateses(Set<RouteUnPrintTemplates> routeUnPrintTemplateses) {
        this.routeUnPrintTemplateses = routeUnPrintTemplateses;
    }

    public boolean hasDoc(String docName) {
        for (RouteDoc routeDoc : getRouteDocs()) {
            if (routeDoc.getDocDir().getName().toUpperCase().equals(docName.toUpperCase())) {
                return true;
            }
        }
        return false;
    }
}
